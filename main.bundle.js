!function(e){function t(t){for(var n,r,o=t[0],s=t[1],a=t[2],c=0,l=[];c<o.length;c++)r=o[c],Object.prototype.hasOwnProperty.call(C,r)&&C[r]&&l.push(C[r][0]),C[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(B&&B(t);l.length;)l.shift()();return I.push.apply(I,a||[]),i()}function i(){for(var e,t=0;t<I.length;t++){for(var i=I[t],n=!0,r=1;r<i.length;r++){var o=i[r];0!==C[o]&&(n=!1)}n&&(I.splice(t--,1),e=A(A.s=i[0]))}return e}var n=window.webpackHotUpdate;window.webpackHotUpdate=function(e,t){!function(e,t){if(!T[e]||!x[e])return;for(var i in x[e]=!1,t)Object.prototype.hasOwnProperty.call(t,i)&&(m[i]=t[i]);0==--g&&0===b&&S()}(e,t),n&&n(e,t)};var r,o=!0,s="73e7d6a5cd62b2ed909f",a={},c=[],l=[];function u(t){var i={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:r!==t,active:!0,accept:function(e,t){if(void 0===e)i._selfAccepted=!0;else if("function"==typeof e)i._selfAccepted=e;else if("object"==typeof e)for(var n=0;n<e.length;n++)i._acceptedDependencies[e[n]]=t||function(){};else i._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)i._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)i._declinedDependencies[e[t]]=!0;else i._declinedDependencies[e]=!0},dispose:function(e){i._disposeHandlers.push(e)},addDisposeHandler:function(e){i._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=i._disposeHandlers.indexOf(e);t>=0&&i._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,h){case"idle":(m={})[t]=e[t],f("ready");break;case"ready":L(t);break;case"prepare":case"check":case"dispose":case"apply":(y=y||[]).push(t)}},check:P,apply:M,status:function(e){if(!e)return h;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:a[t]};return r=void 0,i}var d=[],h="idle";function f(e){h=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var p,m,v,y,g=0,b=0,w={},x={},T={};function O(e){return+e+""===e?+e:e}function P(e){if("idle"!==h)throw new Error("check() is only allowed in idle status");return o=e,f("check"),(t=1e4,t=t||1e4,new Promise((function(e,i){if("undefined"==typeof XMLHttpRequest)return i(new Error("No browser support"));try{var n=new XMLHttpRequest,r=A.p+""+s+".hot-update.json";n.open("GET",r,!0),n.timeout=t,n.send(null)}catch(e){return i(e)}n.onreadystatechange=function(){if(4===n.readyState)if(0===n.status)i(new Error("Manifest request to "+r+" timed out."));else if(404===n.status)e();else if(200!==n.status&&304!==n.status)i(new Error("Manifest request to "+r+" failed."));else{try{var t=JSON.parse(n.responseText)}catch(e){return void i(e)}e(t)}}}))).then((function(e){if(!e)return f(E()?"ready":"idle"),null;x={},w={},T=e.c,v=e.h,f("prepare");var t=new Promise((function(e,t){p={resolve:e,reject:t}}));for(var i in m={},C)_(i);return"prepare"===h&&0===b&&0===g&&S(),t}));var t}function _(e){T[e]?(x[e]=!0,g++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=A.p+""+e+"."+s+".hot-update.js",document.head.appendChild(t)}(e)):w[e]=!0}function S(){f("ready");var e=p;if(p=null,e)if(o)Promise.resolve().then((function(){return M(o)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var i in m)Object.prototype.hasOwnProperty.call(m,i)&&t.push(O(i));e.resolve(t)}}function M(t){if("ready"!==h)throw new Error("apply() is only allowed in ready status");return function t(i){var n,o,l,u,d;function h(e){for(var t=[e],i={},n=t.map((function(e){return{chain:[e],id:e}}));n.length>0;){var r=n.pop(),o=r.id,s=r.chain;if((u=j[o])&&(!u.hot._selfAccepted||u.hot._selfInvalidated)){if(u.hot._selfDeclined)return{type:"self-declined",chain:s,moduleId:o};if(u.hot._main)return{type:"unaccepted",chain:s,moduleId:o};for(var a=0;a<u.parents.length;a++){var c=u.parents[a],l=j[c];if(l){if(l.hot._declinedDependencies[o])return{type:"declined",chain:s.concat([c]),moduleId:o,parentId:c};-1===t.indexOf(c)&&(l.hot._acceptedDependencies[o]?(i[c]||(i[c]=[]),p(i[c],[o])):(delete i[c],t.push(c),n.push({chain:s.concat([c]),id:c})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:i}}function p(e,t){for(var i=0;i<t.length;i++){var n=t[i];-1===e.indexOf(n)&&e.push(n)}}E();var g={},b=[],w={},x=function(){console.warn("[HMR] unexpected require("+_.moduleId+") to disposed module")};for(var P in m)if(Object.prototype.hasOwnProperty.call(m,P)){var _;d=O(P),_=m[P]?h(d):{type:"disposed",moduleId:P};var S=!1,M=!1,L=!1,I="";switch(_.chain&&(I="\nUpdate propagation: "+_.chain.join(" -> ")),_.type){case"self-declined":i.onDeclined&&i.onDeclined(_),i.ignoreDeclined||(S=new Error("Aborted because of self decline: "+_.moduleId+I));break;case"declined":i.onDeclined&&i.onDeclined(_),i.ignoreDeclined||(S=new Error("Aborted because of declined dependency: "+_.moduleId+" in "+_.parentId+I));break;case"unaccepted":i.onUnaccepted&&i.onUnaccepted(_),i.ignoreUnaccepted||(S=new Error("Aborted because "+d+" is not accepted"+I));break;case"accepted":i.onAccepted&&i.onAccepted(_),M=!0;break;case"disposed":i.onDisposed&&i.onDisposed(_),L=!0;break;default:throw new Error("Unexception type "+_.type)}if(S)return f("abort"),Promise.reject(S);if(M)for(d in w[d]=m[d],p(b,_.outdatedModules),_.outdatedDependencies)Object.prototype.hasOwnProperty.call(_.outdatedDependencies,d)&&(g[d]||(g[d]=[]),p(g[d],_.outdatedDependencies[d]));L&&(p(b,[_.moduleId]),w[d]=x)}var R,N=[];for(o=0;o<b.length;o++)d=b[o],j[d]&&j[d].hot._selfAccepted&&w[d]!==x&&!j[d].hot._selfInvalidated&&N.push({module:d,parents:j[d].parents.slice(),errorHandler:j[d].hot._selfAccepted});f("dispose"),Object.keys(T).forEach((function(e){!1===T[e]&&function(e){delete C[e]}(e)}));var V,B,D=b.slice();for(;D.length>0;)if(d=D.pop(),u=j[d]){var F={},U=u.hot._disposeHandlers;for(l=0;l<U.length;l++)(n=U[l])(F);for(a[d]=F,u.hot.active=!1,delete j[d],delete g[d],l=0;l<u.children.length;l++){var k=j[u.children[l]];k&&((R=k.parents.indexOf(d))>=0&&k.parents.splice(R,1))}}for(d in g)if(Object.prototype.hasOwnProperty.call(g,d)&&(u=j[d]))for(B=g[d],l=0;l<B.length;l++)V=B[l],(R=u.children.indexOf(V))>=0&&u.children.splice(R,1);f("apply"),void 0!==v&&(s=v,v=void 0);for(d in m=void 0,w)Object.prototype.hasOwnProperty.call(w,d)&&(e[d]=w[d]);var G=null;for(d in g)if(Object.prototype.hasOwnProperty.call(g,d)&&(u=j[d])){B=g[d];var H=[];for(o=0;o<B.length;o++)if(V=B[o],n=u.hot._acceptedDependencies[V]){if(-1!==H.indexOf(n))continue;H.push(n)}for(o=0;o<H.length;o++){n=H[o];try{n(B)}catch(e){i.onErrored&&i.onErrored({type:"accept-errored",moduleId:d,dependencyId:B[o],error:e}),i.ignoreErrored||G||(G=e)}}}for(o=0;o<N.length;o++){var K=N[o];d=K.module,c=K.parents,r=d;try{A(d)}catch(e){if("function"==typeof K.errorHandler)try{K.errorHandler(e)}catch(t){i.onErrored&&i.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:t,originalError:e}),i.ignoreErrored||G||(G=t),G||(G=e)}else i.onErrored&&i.onErrored({type:"self-accept-errored",moduleId:d,error:e}),i.ignoreErrored||G||(G=e)}}if(G)return f("fail"),Promise.reject(G);if(y)return t(i).then((function(e){return b.forEach((function(t){e.indexOf(t)<0&&e.push(t)})),e}));return f("idle"),new Promise((function(e){e(b)}))}(t=t||{})}function E(){if(y)return m||(m={}),y.forEach(L),y=void 0,!0}function L(t){Object.prototype.hasOwnProperty.call(m,t)||(m[t]=e[t])}var j={},C={0:0},I=[];function A(t){if(j[t])return j[t].exports;var i=j[t]={i:t,l:!1,exports:{},hot:u(t),parents:(l=c,c=[],l),children:[]};return e[t].call(i.exports,i,i.exports,function(e){var t=j[e];if(!t)return A;var i=function(i){return t.hot.active?(j[i]?-1===j[i].parents.indexOf(e)&&j[i].parents.push(e):(c=[e],r=i),-1===t.children.indexOf(i)&&t.children.push(i)):(console.warn("[HMR] unexpected require("+i+") from disposed module "+e),c=[]),A(i)},n=function(e){return{configurable:!0,enumerable:!0,get:function(){return A[e]},set:function(t){A[e]=t}}};for(var o in A)Object.prototype.hasOwnProperty.call(A,o)&&"e"!==o&&"t"!==o&&Object.defineProperty(i,o,n(o));return i.e=function(e){return"ready"===h&&f("prepare"),b++,A.e(e).then(t,(function(e){throw t(),e}));function t(){b--,"prepare"===h&&(w[e]||_(e),0===b&&0===g&&S())}},i.t=function(e,t){return 1&t&&(e=i(e)),A.t(e,-2&t)},i}(t)),i.l=!0,i.exports}A.m=e,A.c=j,A.d=function(e,t,i){A.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},A.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},A.t=function(e,t){if(1&t&&(e=A(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(A.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)A.d(i,n,function(t){return e[t]}.bind(null,n));return i},A.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return A.d(t,"a",t),t},A.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},A.p="",A.h=function(){return s};var R=window.webpackJsonp=window.webpackJsonp||[],N=R.push.bind(R);R.push=t,R=R.slice();for(var V=0;V<R.length;V++)t(R[V]);var B=N;I.push([28,1]),i()}([,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameObject=void 0;const n=i(4);class r extends n.Object3D{}t.GameObject=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Light=void 0;const n=i(4);class r extends n.Object3D{constructor(e={}){var t,i;super(e),this.name="Light",this.color=null!==(t=e.color)&&void 0!==t?t:[0,0,0],this.intensity=null!==(i=e.intensity)&&void 0!==i?i:1}}t.Light=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Object3D=void 0;const n=i(1);class r{constructor(e={}){var t,i;this.name=null!==(t=e.name)&&void 0!==t?t:"Object3D",this.translation=e.translation?n.vec3.clone(e.translation):n.vec3.fromValues(0,0,0),this.rotation=e.rotation?n.quat.clone(e.rotation):n.quat.fromValues(0,0,0,1),this.scale=e.scale?n.vec3.clone(e.scale):n.vec3.fromValues(1,1,1),this.matrix=e.matrix?n.mat4.clone(e.matrix):n.mat4.create(),e.matrix?this.updateTransform():(e.translation||e.rotation||e.scale)&&this.updateMatrix(),this.mesh=e.mesh||null,this.children=null!==(i=e.children)&&void 0!==i?i:[];for(const e of this.children)e.parent=this;this.parent=null}traverse(e){var t,i;null===(t=null==e?void 0:e.onEnter)||void 0===t||t.call(e,this);for(const t of this.children)t.traverse(e);null===(i=null==e?void 0:e.onLeave)||void 0===i||i.call(e,this)}updateTransform(){n.mat4.getRotation(this.rotation,this.matrix),n.mat4.getTranslation(this.translation,this.matrix),n.mat4.getScaling(this.scale,this.matrix)}updateMatrix(){n.mat4.fromRotationTranslationScale(this.matrix,this.rotation,this.translation,this.scale)}getGlobalTransform(){if(this.parent){let e=this.parent.getGlobalTransform();return n.mat4.mul(e,e,this.matrix)}return n.mat4.clone(this.matrix)}addChild(e){this.children.push(e),e.parent=this}removeChild(e){const t=this.children.indexOf(e);t>=0&&(this.children.splice(t,1),e.parent=null)}clone(){return new r(Object.assign(Object.assign({},this),{children:this.children.map(e=>e.clone())}))}}t.Object3D=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Material=void 0;const n=i(1);t.Material=class{constructor(e){var t;this.baseColorTexture=e.baseColorTexture||null,this.baseColorTexCoord=e.baseColorTexCoord||0,this.baseColorFactor=e.baseColorFactor?n.vec4.clone(e.baseColorFactor):n.vec4.fromValues(1,1,1,1),this.baseColorTransform=null!==(t=e.baseColorTransform)&&void 0!==t?t:n.mat3.create(),this.metallicRoughnessTexture=e.metallicRoughnessTexture||null,this.metallicRoughnessTexCoord=e.metallicRoughnessTexCoord||0,this.metallicFactor=void 0!==e.metallicFactor?e.metallicFactor:1,this.roughnessFactor=void 0!==e.roughnessFactor?e.roughnessFactor:1,this.normalTexture=e.normalTexture||null,this.normalTexCoord=e.normalTexCoord||0,this.normalFactor=void 0!==e.normalFactor?e.normalFactor:1,this.occlusionTexture=e.occlusionTexture||null,this.occlusionTexCoord=e.occlusionTexCoord||0,this.occlusionFactor=void 0!==e.occlusionFactor?e.occlusionFactor:1,this.emissiveTexture=e.emissiveTexture||null,this.emissiveTexCoord=e.emissiveTexCoord||0,this.emissiveFactor=e.emissiveFactor?n.vec3.clone(e.emissiveFactor):n.vec3.fromValues(0,0,0),this.alphaMode=e.alphaMode||"OPAQUE",this.alphaCutoff=void 0!==e.alphaCutoff?e.alphaCutoff:.5,this.doubleSided=e.doubleSided||!1}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;const r=i(13),o=i(1),s=i(0),a=i(15);class c extends a.Sphere{constructor(e){super(Object.assign(Object.assign({},e),{name:"Player",radius:.2,mass:10})),this.camera=new r.PerspectiveCamera({fov:1.8,near:.05}),this.addChild(this.camera),this.foundKeys=[]}load(){const e=Object.create(null,{load:{get:()=>super.load}});return n(this,void 0,void 0,(function*(){yield e.load.call(this),this.controls=new l(this.body)}))}update(e,t){this.controls.update();const[i,n,r]=this.controls.rotation.map(e=>180*e/Math.PI);this.camera.rotation=o.quat.fromEuler(o.quat.create(),i,n,r),this.camera.updateMatrix(),super.update(e,t)}pickupKey(e){this.foundKeys.push(e)}}t.Player=c;class l{constructor(e,t={}){var i;this.body=e,this.rotation=[0,0,0],this.velocityFactor=null!==(i=t.velocityFactor)&&void 0!==i?i:.04,this.mouseSensitivity=t.mouseSensitivity||.01,this.mousemoveHandler=this.mousemoveHandler.bind(this),this.keydownHandler=this.keydownHandler.bind(this),this.keyupHandler=this.keyupHandler.bind(this),this.pressedKeys={}}update(){const{body:e,velocityFactor:t,rotation:i}=this,n=o.vec3.fromValues(-Math.sin(i[1]),0,-Math.cos(i[1])),r=o.vec3.fromValues(Math.cos(i[1]),0,-Math.sin(i[1])),a=o.vec3.fromValues(0,5,0),c=o.vec3.create();this.pressedKeys.KeyW&&o.vec3.add(c,c,n),this.pressedKeys.KeyS&&o.vec3.sub(c,c,n),this.pressedKeys.KeyD&&o.vec3.add(c,c,r),this.pressedKeys.KeyA&&o.vec3.sub(c,c,r),this.pressedKeys.Space&&o.vec3.add(c,c,a),o.vec3.scale(c,c,t),e.velocity=e.velocity.vadd(new s.Vec3(...c))}enable(){document.addEventListener("mousemove",this.mousemoveHandler),document.addEventListener("keydown",this.keydownHandler),document.addEventListener("keyup",this.keyupHandler)}disable(){document.removeEventListener("mousemove",this.mousemoveHandler),document.removeEventListener("keydown",this.keydownHandler),document.removeEventListener("keyup",this.keyupHandler);for(let e in this.pressedKeys)this.pressedKeys[e]=!1}mousemoveHandler(e){const t=e.movementX,i=e.movementY,{rotation:n,mouseSensitivity:r}=this;n[0]-=i*r,n[1]-=t*r;const o=Math.PI,s=2*o,a=o/2;n[0]>a&&(n[0]=a),n[0]<-a&&(n[0]=-a),n[1]=(n[1]%s+s)%s}keydownHandler(e){this.pressedKeys[e.code]=!0}keyupHandler(e){this.pressedKeys[e.code]=!1}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mesh=void 0;t.Mesh=class{constructor(e){var t;this.primitives=null!==(t=e.primitives)&&void 0!==t?t:[]}setMaterial(e){this.primitives.forEach(t=>{t.material=e})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AmbientLight=void 0;const n=i(3);class r extends n.Light{constructor(e){var t,i;super(e),this.name=null!==(t=e.name)&&void 0!==t?t:"AmbientLight",this.color=null!==(i=e.color)&&void 0!==i?i:[51,51,51]}}t.AmbientLight=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectionalLight=void 0;const n=i(3),r=[0,1,0];class o extends n.Light{constructor(e={}){var t,i;super(e),this.name="DirectionalLight",this.color=null!==(t=e.color)&&void 0!==t?t:[50,50,50],this.direction=null!==(i=e.direction)&&void 0!==i?i:r}}t.DirectionalLight=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PointLight=void 0;const n=i(3);class r extends n.Light{constructor(e){super(e)}}t.PointLight=r},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GameScene=void 0;const r=i(12),o=i(2),s=i(0),a=i(6);class c extends r.Scene{constructor(){super(),this.world=new s.World({gravity:new s.Vec3(0,-9.82,0)})}start(){return n(this,void 0,void 0,(function*(){const e=[];this.traverse({onEnter:t=>{t instanceof o.GameObject&&e.push(t.load())}}),yield Promise.all(e),this.traverse({onEnter:e=>{e instanceof o.GameObject&&e.body&&this.world.addBody(e.body)}})}))}update(e,t){this.world.fixedStep(),this.traverse({onEnter:i=>{i instanceof o.GameObject&&i.update(e,t)}})}resize(e){this.traverse({onEnter:t=>{t instanceof a.Player&&(t.camera.aspect=e,t.camera.updateMatrix())}})}}t.GameScene=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scene=void 0;t.Scene=class{constructor(e){var t;this.nodes=null!==(t=null==e?void 0:e.nodes)&&void 0!==t?t:[]}addNode(...e){this.nodes.push(...e)}traverse(e){for(const t of this.nodes)t.traverse(e)}findNodesByName(e){const t=[];return this.traverse({onEnter:i=>{i.name===e&&t.push(i)}}),t}findNodesByNamePattern(e){const t=[];return this.traverse({onEnter:i=>{new RegExp(e).test(i.name)&&t.push(i)}}),t}findNodes(e){const t=[];return this.traverse({onEnter:i=>{e(i)&&t.push(i)}}),t}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PerspectiveCamera=void 0;const n=i(1),r=i(14);class o extends r.Camera{constructor(e={}){var t,i,r,o;super(e),this.aspect=null!==(t=e.aspect)&&void 0!==t?t:1.5,this.fov=null!==(i=e.fov)&&void 0!==i?i:1.5,this.near=null!==(r=e.near)&&void 0!==r?r:.1,this.far=null!==(o=e.far)&&void 0!==o?o:1/0,this.projection=n.mat4.create(),this.updateProjection()}updateProjection(){n.mat4.perspective(this.projection,this.fov,this.aspect,this.near,this.far)}}t.PerspectiveCamera=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=void 0;const n=i(1),r=i(4);class o extends r.Object3D{constructor(e={}){super(e),this.projection=n.mat4.create()}}t.Camera=o},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Sphere=void 0;const r=i(2),o=i(7),s=i(16),a=i(0);class c extends r.GameObject{constructor(e){var t,i;super(e),this.name=null!==(t=e.name)&&void 0!==t?t:"Sphere",this.physicsMaterial=e.physicsMaterial,this.radius=e.radius,this.mass=null!==(i=e.mass)&&void 0!==i?i:.1}load(){return n(this,void 0,void 0,(function*(){this.mesh=new o.Mesh({primitives:[new s.SpherePrimitive({radius:this.radius,subdivisionsHeight:100,subdivisionsAxis:100})]}),this.body=new a.Body({mass:this.mass,material:this.physicsMaterial,shape:new a.Sphere(this.radius),position:new a.Vec3(...this.translation),quaternion:new a.Quaternion(...this.rotation)})}))}update(e,t){this.translation=this.body.position.toArray(),this.updateMatrix()}}t.Sphere=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpherePrimitive=void 0;const n=i(17),r=i(18);class o extends r.TwglPrimitive{constructor(e){super(Object.assign(Object.assign({},e),{vertices:n.primitives.createSphereVertices(e.radius,e.subdivisionsAxis,e.subdivisionsHeight)}))}}t.SpherePrimitive=o},,function(e,t,i){"use strict";var n=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};Object.defineProperty(t,"__esModule",{value:!0}),t.TwglPrimitive=void 0;const r=i(19),o=i(20),s=i(21);class a extends s.Primitive{constructor(e){const{vertices:t}=e,i=n(e,["vertices"]),s={POSITION:new r.Accessor({numComponents:3,componentType:5126,count:t.position.length,bufferView:a(t.position)}),NORMAL:new r.Accessor({numComponents:3,componentType:5126,count:t.normal.length,bufferView:a(t.normal)}),TEXCOORD_0:new r.Accessor({numComponents:2,componentType:5126,count:t.texcoord.length,bufferView:a(t.texcoord)})};function a(e){return new o.BufferView({buffer:e.buffer,byteLength:e.byteLength,byteOffset:e.byteOffset,byteStride:0})}super(Object.assign({indices:new r.Accessor({numComponents:3,componentType:5123,count:t.indices.length,bufferView:a(t.indices)}),attributes:s},i))}}t.TwglPrimitive=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Accessor=void 0;t.Accessor=class{constructor(e){this.bufferView=e.bufferView||null,this.byteOffset=e.byteOffset||0,this.componentType=e.componentType||5120,this.normalized=e.normalized||!1,this.count=e.count||0,this.numComponents=e.numComponents||0,this.min=e.min||null,this.max=e.max||null}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferView=void 0;t.BufferView=class{constructor(e){this.buffer=e.buffer||null,this.byteOffset=e.byteOffset||0,this.byteLength=e.byteLength||0,this.byteStride=void 0!==e.byteStride?e.byteStride:null}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPrimitiveAttributeName=t.Primitive=void 0;const n=i(5);t.Primitive=class{constructor(e={}){var t,i,r;this.attributes=null!==(t=e.attributes)&&void 0!==t?t:{POSITION:null,TEXCOORD_0:null,NORMAL:null},this.indices=null!==(i=e.indices)&&void 0!==i?i:null,this.mode=void 0!==e.mode?e.mode:4,this.material=null!==(r=e.material)&&void 0!==r?r:new n.Material({})}setAttribute(e,t){this.attributes[e]=t}},t.isPrimitiveAttributeName=function(e){var t;return null!==(t={NORMAL:!0,POSITION:!0,TEXCOORD_0:!0}[e])&&void 0!==t&&t}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFLoader=void 0;const r=i(23),o=i(24),s=i(5),a=i(21),c=i(7),l=i(13),u=i(37),d=i(4),h=i(12),f=i(38),p=i(20),m=i(19),v=i(10),y=i(1);t.GLTFLoader=class{constructor(){this.gltf=null,this.gltfUrl=null,this.cache=new Map}fetchJson(e){return n(this,void 0,void 0,(function*(){let t=yield fetch(e);return yield t.json()}))}fetchBuffer(e){return n(this,void 0,void 0,(function*(){let t=yield fetch(e);return yield t.arrayBuffer()}))}fetchImage(e){return new Promise((t,i)=>{let n=new Image;n.addEventListener("load",e=>t(n)),n.addEventListener("error",i),n.src=e})}findByNameOrIndex(e,t){return"number"==typeof t?e[t]:e.find(e=>e.name===t)}load(e){return n(this,void 0,void 0,(function*(){this.gltfUrl=new URL(e,window.location.href),this.gltf=yield this.fetchJson(e),this.defaultScene=this.gltf.scene||0}))}loadImage(e){return n(this,void 0,void 0,(function*(){const t=this.findByNameOrIndex(this.gltf.images,e);if(this.cache.has(t))return this.cache.get(t);if(t.uri){const e=new URL(t.uri,this.gltfUrl),i=yield this.fetchImage(e.toString());return this.cache.set(t,i),i}{const e=yield this.loadBufferView(t.bufferView),i=new Blob([e],{type:t.mimeType}),n=URL.createObjectURL(i),r=yield this.fetchImage(n);return URL.revokeObjectURL(n),this.cache.set(t,r),r}}))}loadBuffer(e){return n(this,void 0,void 0,(function*(){const t=this.findByNameOrIndex(this.gltf.buffers,e);if(this.cache.has(t))return this.cache.get(t);const i=new URL(t.uri,this.gltfUrl),n=yield this.fetchBuffer(i.toString());return this.cache.set(t,n),n}))}loadBufferView(e){return n(this,void 0,void 0,(function*(){const t=this.findByNameOrIndex(this.gltf.bufferViews,e);if(this.cache.has(t))return this.cache.get(t);const i=new p.BufferView(Object.assign(Object.assign({},t),{buffer:yield this.loadBuffer(t.buffer)}));return this.cache.set(t,i),i}))}loadAccessor(e){return n(this,void 0,void 0,(function*(){const t=this.findByNameOrIndex(this.gltf.accessors,e);if(this.cache.has(t))return this.cache.get(t);const i=new Map([["SCALAR",1],["VEC2",2],["VEC3",3],["VEC4",4],["MAT2",4],["MAT3",9],["MAT4",16]]),n=new m.Accessor(Object.assign(Object.assign({},t),{bufferView:yield this.loadBufferView(t.bufferView),numComponents:i.get(t.type)}));return this.cache.set(t,n),n}))}loadSampler(e){return n(this,void 0,void 0,(function*(){const t=this.findByNameOrIndex(this.gltf.samplers,e);if(this.cache.has(t))return this.cache.get(t);const i=new r.TextureSampler({min:t.minFilter,mag:t.magFilter,wrapS:t.wrapS,wrapT:t.wrapT});return this.cache.set(t,i),i}))}loadTexture(e){return n(this,void 0,void 0,(function*(){const t=this.findByNameOrIndex(this.gltf.textures,e);if(this.cache.has(t))return this.cache.get(t);let i={};void 0!==t.source&&(i.image=yield this.loadImage(t.source)),void 0!==t.sampler&&(i.sampler=yield this.loadSampler(t.sampler));const n=new o.Texture(i);return this.cache.set(t,n),n}))}loadMaterial(e){return n(this,void 0,void 0,(function*(){const t=this.findByNameOrIndex(this.gltf.materials,e);if(this.cache.has(t))return this.cache.get(t);let i={};const n=t.pbrMetallicRoughness;void 0!==n&&(void 0!==n.baseColorTexture&&(i.baseColorTexture=yield this.loadTexture(n.baseColorTexture.index),i.baseColorTexCoord=n.baseColorTexture.texCoord,i.baseColorTransform=this.getTextureTransform(n.baseColorTexture)),void 0!==n.metallicRoughnessTexture&&(i.metallicRoughnessTexture=yield this.loadTexture(n.metallicRoughnessTexture.index),i.metallicRoughnessTexCoord=n.metallicRoughnessTexture.texCoord),i.baseColorFactor=n.baseColorFactor,i.metallicFactor=n.metallicFactor,i.roughnessFactor=n.roughnessFactor),void 0!==t.normalTexture&&(i.normalTexture=yield this.loadTexture(t.normalTexture.index),i.normalTexCoord=t.normalTexture.texCoord,i.normalFactor=t.normalTexture.scale),void 0!==t.occlusionTexture&&(i.occlusionTexture=yield this.loadTexture(t.occlusionTexture.index),i.occlusionTexCoord=t.occlusionTexture.texCoord,i.occlusionFactor=t.occlusionTexture.strength),void 0!==t.emissiveTexture&&(i.emissiveTexture=yield this.loadTexture(t.emissiveTexture.index),i.emissiveTexCoord=t.emissiveTexture.texCoord,i.emissiveFactor=t.emissiveFactor),i.alphaMode=t.alphaMode,i.alphaCutoff=t.alphaCutoff,i.doubleSided=t.doubleSided;const r=new s.Material(i);return this.cache.set(t,r),r}))}getTextureTransform(e){var t;const i=null===(t=e.extensions)||void 0===t?void 0:t.KHR_texture_transform,n=y.mat3.create();if(!i)return n;let r=y.mat3.create();i.scale&&y.mat3.fromScaling(r,i.scale);let o=y.mat3.create();i.offset&&y.mat3.fromTranslation(o,i.offset);let s=y.mat3.create();return i.rotation&&y.mat3.fromRotation(s,i.rotation),y.mat3.multiply(n,n,r),y.mat3.multiply(n,n,o),y.mat3.multiply(n,n,s),n}loadMesh(e){return n(this,void 0,void 0,(function*(){const t=this.findByNameOrIndex(this.gltf.meshes,e);if(this.cache.has(t))return this.cache.get(t);let i={primitives:[]};for(const e of t.primitives){let t={attributes:{NORMAL:null,TEXCOORD_0:null,POSITION:null}};for(const i in e.attributes)(0,a.isPrimitiveAttributeName)(i)?t.attributes[i]=yield this.loadAccessor(e.attributes[i]):console.error("Unsupported primitive attribute: "+i);void 0!==e.indices&&(t.indices=yield this.loadAccessor(e.indices)),void 0!==e.material&&(t.material=yield this.loadMaterial(e.material)),t.mode=e.mode;const n=new a.Primitive(t);i.primitives.push(n)}const n=new c.Mesh(i);return this.cache.set(t,n),n}))}loadLight(e){return n(this,void 0,void 0,(function*(){const t=this.findByNameOrIndex((0,f.deep)(this.gltf,"extensions.KHR_lights_punctual.lights"),e);if(this.cache.has(t))return this.cache.get(t);const i=y.vec3.create();y.vec3.scale(i,t.color,255);const n=function(){switch(t.type){case"point":return new v.PointLight({name:t.name,color:i,intensity:t.intensity?t.intensity/5:1})}}();return this.cache.set(t,n),n}))}loadCamera(e){return n(this,void 0,void 0,(function*(){const t=this.findByNameOrIndex(this.gltf.cameras,e);if(this.cache.has(t))return this.cache.get(t);if("perspective"===t.type){const e=t.perspective,i=new l.PerspectiveCamera({aspect:e.aspectRatio,fov:e.yfov,near:e.znear,far:e.zfar});return this.cache.set(t,i),i}if("orthographic"===t.type){const e=t.orthographic,i=new u.OrthographicCamera({left:-e.xmag,right:e.xmag,bottom:-e.ymag,top:e.ymag,near:e.znear,far:e.zfar});return this.cache.set(t,i),i}}))}loadNode(e){var t,i,r;return n(this,void 0,void 0,(function*(){const n=this.findByNameOrIndex(this.gltf.nodes,e);if(!n)throw new Error("Cant find node with index "+e);if(this.cache.has(n))return this.cache.get(n);let o=new d.Object3D;const s=(0,f.deep)(n,"extensions.KHR_lights_punctual.light");if(void 0!==s&&(o=yield this.loadLight(s)),o.name=n.name,n.matrix?(o.matrix=n.matrix,o.updateTransform()):(n.translation||n.rotation||n.scale)&&(o.translation=null!==(t=n.translation)&&void 0!==t?t:y.vec3.fromValues(0,0,0),o.scale=null!==(i=n.scale)&&void 0!==i?i:y.vec3.fromValues(1,1,1),o.rotation=null!==(r=n.rotation)&&void 0!==r?r:y.quat.fromValues(0,0,0,1),o.updateMatrix()),n.children)for(const e of n.children)o.addChild(yield this.loadNode(e));return void 0!==n.mesh&&(o.mesh=yield this.loadMesh(n.mesh)),this.cache.set(n,o),o}))}loadScene(e){return n(this,void 0,void 0,(function*(){const t=this.findByNameOrIndex(this.gltf.scenes,e);if(this.cache.has(t))return this.cache.get(t);let i={nodes:[]};if(t.nodes)for(const e of t.nodes){const t=yield this.loadNode(e);i.nodes.push(t)}const n=new h.Scene(i);return this.cache.set(t,n),n}))}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextureSampler=void 0;t.TextureSampler=class{constructor(e={}){this.mag=e.mag||9729,this.min=e.min||9729,this.wrapS=e.wrapS||10497,this.wrapT=e.wrapT||10497}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Texture=void 0;const n=i(23);t.Texture=class{constructor(e){var t,i,r;this.image=null!==(t=e.image)&&void 0!==t?t:null,this.sampler=null!==(i=e.sampler)&&void 0!==i?i:new n.TextureSampler,this.hasMipmaps=null!==(r=e.hasMipmaps)&&void 0!==r&&r}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Wall=void 0;const r=i(2),o=i(0),s=i(41);class a extends r.GameObject{constructor(e,t){super(),Object.assign(this,e),this.physicsMaterial=t.physicsMaterial;const i=(0,s.meshToCannonShape)(this.mesh);i.setScale(new o.Vec3(...this.scale)),this.body=new o.Body({type:o.BODY_TYPES.STATIC,material:this.physicsMaterial,position:new o.Vec3(...this.translation),quaternion:new o.Quaternion(...this.rotation),shape:i})}load(){return n(this,void 0,void 0,(function*(){}))}update(){this.translation=this.body.position.toArray(),this.updateMatrix()}}t.Wall=a},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UiController=void 0;class n{constructor(){this.startButton=document.getElementById("start-button"),this.restartButton=document.getElementById("restart-button"),this.startOverButton=document.getElementById("start-over-button"),this.startScreen=document.getElementById("start-screen"),this.loseScreen=document.getElementById("lose-screen"),this.winScreen=document.getElementById("win-screen"),this.gameStatusPanel=document.getElementById("game-status-panel"),this.timeLeftValue=document.getElementById("time-left-value"),this.keysFoundValue=document.getElementById("keys-found-value"),this.canvas=document.querySelector("canvas")}static create(){return n.instance||(n.instance=new n),n.instance}showStartScreen(){this.setIsVisible(this.startScreen,!0),this.setIsVisible(this.loseScreen,!1),this.setIsVisible(this.winScreen,!1),this.setIsVisible(this.gameStatusPanel,!1),this.setIsVisible(this.canvas,!1)}showLoseScreen(){this.setIsVisible(this.startScreen,!1),this.setIsVisible(this.loseScreen,!0),this.setIsVisible(this.winScreen,!1),this.setIsVisible(this.gameStatusPanel,!1),this.setIsVisible(this.canvas,!1)}showWinScreen(){this.setIsVisible(this.startScreen,!1),this.setIsVisible(this.loseScreen,!1),this.setIsVisible(this.winScreen,!0),this.setIsVisible(this.gameStatusPanel,!1),this.setIsVisible(this.canvas,!1)}showGameScreen(){this.setIsVisible(this.startScreen,!1),this.setIsVisible(this.loseScreen,!1),this.setIsVisible(this.winScreen,!1),this.setIsVisible(this.gameStatusPanel,!0),this.setIsVisible(this.canvas,!0)}setTimeLeft(e){console.log(e),this.timeLeftValue.innerText=e+"s"}setKeysFound(e){this.keysFoundValue.innerText=`${e.foundKeys} / ${e.totalKeys}`}setIsStartScreenLoading(e){e?(this.startButton.innerText="Loading...",this.startButton.setAttribute("disabled","")):(this.startButton.innerText="Start",this.startButton.removeAttribute("disabled"))}setIsVisible(e,t){e.style.display=t?"flex":"none"}}t.UiController=n},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),i(29);const r=i(30),o=(i(31),i(32)),s=i(1),a=(i(36),i(43)),c=i(6),l=i(27),u=i(26);class d extends r.WebGlApplication{constructor(){super(...arguments),this.sound=new u.Howl({src:["./sounds/background2.mp3"],html5:!0,volume:.15,loop:!0}),this.cameraConfig={fov:1.8},this.rotatingObjectConfig={name:"Monkey",rotationX:0,rotationY:0,rotationZ:0}}start(){const e=Object.create(null,{start:{get:()=>super.start}});return n(this,void 0,void 0,(function*(){this.scene=new a.LabyrinthScene,yield this.scene.start(),console.log(this.scene),this.sound.play();const t=this.scene.findNodes(e=>e instanceof c.Player)[0];if(!t)throw new Error("Player not found in the scene");this.player=t,this.renderer=new o.WebGLRenderer(this.gl,{clearColor:[1,1,1,1]}),this.renderer.prepareScene(this.scene),e.start.call(this)}))}update(e,t){this.rotateTargetObject(),this.scene.update(e,t),this.player.camera.fov=this.cameraConfig.fov,this.player.camera.updateProjection()}rotateTargetObject(){const e=this.scene.findNodesByNamePattern(this.rotatingObjectConfig.name);for(const t of e)s.quat.fromEuler(t.rotation,this.rotatingObjectConfig.rotationX,this.rotatingObjectConfig.rotationY,this.rotatingObjectConfig.rotationZ),t.updateMatrix()}render(){this.renderer&&this.renderer.render(this.scene,this.player.camera)}resize(e){this.scene.resize(e)}enableCamera(){this.canvas.requestPointerLock(),document.addEventListener("pointerlockchange",()=>{document.pointerLockElement===this.canvas?this.player.controls.enable():this.player.controls.disable()})}}document.addEventListener("DOMContentLoaded",()=>n(void 0,void 0,void 0,(function*(){const e=l.UiController.create(),t=new d(e.canvas);function i(){return n(this,void 0,void 0,(function*(){t.stop(),e.setIsStartScreenLoading(!0),yield t.start(),e.setIsStartScreenLoading(!1),e.showGameScreen(),t.enableCamera()}))}e.showStartScreen(),e.canvas.addEventListener("click",()=>t.enableCamera()),e.startButton.addEventListener("click",()=>i()),e.restartButton.addEventListener("click",()=>i()),e.startOverButton.addEventListener("click",()=>i())})))},function(e,t,i){},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebGlApplication=void 0;t.WebGlApplication=class{constructor(e,t){this.internalUpdate=this.internalUpdate.bind(this),this.canvas=e,this._initGL(t)}_initGL(e){this.gl=null;try{this.gl=this.canvas.getContext("webgl2",e)}catch(e){}if(!this.gl)throw new Error("Cannot create WebGL 2.0 context")}internalUpdate(e){this.internalResize();const t=.001*e,i=this.t0?t-this.t0:t;this.update(i,t),this.render(i,t),this.t0=t,this.animationFrame=requestAnimationFrame(this.internalUpdate)}internalResize(){const{canvas:e,gl:t}=this;e.width===e.clientWidth&&e.height===e.clientHeight||(e.width=e.clientWidth,e.height=e.clientHeight,t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),this.updateAspectRatio())}updateAspectRatio(){const e=this.canvas.clientWidth/this.canvas.clientHeight;this.resize(e)}start(){this.updateAspectRatio(),this.animationFrame=requestAnimationFrame(this.internalUpdate)}stop(){cancelAnimationFrame(this.animationFrame)}}},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLRenderer=void 0;const n=i(1),r=i(33),o=i(3),s=i(34),a=i(35),c=i(9),l=i(8),u=i(10);t.WebGLRenderer=class{constructor(e,t){var i;this.gl=e,this.clearColor=null!==(i=t.clearColor)&&void 0!==i?i:[1,1,1,1],this.glObjects=new Map,this.programs=new Map,this.defaultTexture=r.WebGL.createTexture(e,{data:new Uint8Array([255,255,255,255]),width:1,height:1});const[n,o,s,a]=this.clearColor;e.clearColor(n,o,s,a),e.enable(e.DEPTH_TEST),e.enable(e.CULL_FACE)}get defaultProgram(){return this.programs.get("default")}preparePrograms(e){const t=r.WebGL.buildProgram(this.gl,{vertex:(0,s.createVertexShader)(e),fragment:(0,s.createFragmentShader)(e)});this.programs.set("default",t)}prepareBufferView(e){if(this.glObjects.has(e))return this.glObjects.get(e);const t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=r.WebGL.createBuffer(this.gl,{target:e.target,data:t});return this.glObjects.set(e,i),i}prepareSampler(e){if(this.glObjects.has(e))return this.glObjects.get(e);const t=r.WebGL.createSampler(this.gl,e);return this.glObjects.set(e,t),t}prepareImage(e){if(this.glObjects.has(e))return this.glObjects.get(e);const t=r.WebGL.createTexture(this.gl,{image:e});return this.glObjects.set(e,t),t}prepareTexture(e){const t=this.gl;this.prepareSampler(e.sampler);const i=this.prepareImage(e.image),n=[t.NEAREST_MIPMAP_NEAREST,t.NEAREST_MIPMAP_LINEAR,t.LINEAR_MIPMAP_NEAREST,t.LINEAR_MIPMAP_LINEAR];!e.hasMipmaps&&n.includes(e.sampler.min)&&(t.bindTexture(t.TEXTURE_2D,i),t.generateMipmap(t.TEXTURE_2D),e.hasMipmaps=!0)}prepareMaterial(e){e instanceof a.default&&this.prepareShaderMaterial(e),e.baseColorTexture&&this.prepareTexture(e.baseColorTexture),e.metallicRoughnessTexture&&this.prepareTexture(e.metallicRoughnessTexture),e.normalTexture&&this.prepareTexture(e.normalTexture),e.occlusionTexture&&this.prepareTexture(e.occlusionTexture),e.emissiveTexture&&this.prepareTexture(e.emissiveTexture)}prepareShaderMaterial(e){try{const t=r.WebGL.buildProgram(this.gl,{vertex:(0,s.createVertexShader)({numberOfLights:1}),fragment:e.fragmentShader});this.programs.set(e,t)}catch(e){throw new Error("ShaderMaterial error: "+e)}}preparePrimitive(e){if(this.glObjects.has(e))return this.glObjects.get(e);this.prepareMaterial(e.material);const t=this.gl,i=t.createVertexArray();if(t.bindVertexArray(i),e.indices){const i=e.indices.bufferView;i.target=t.ELEMENT_ARRAY_BUFFER;const n=this.prepareBufferView(i);t.bindBuffer(i.target,n)}const n={POSITION:0,TEXCOORD_0:1,NORMAL:2};for(const i in e.attributes){const r=i,o=e.attributes[r],s=o.bufferView,a=n[r];if(void 0!==a){s.target=t.ARRAY_BUFFER;const e=this.prepareBufferView(s);t.bindBuffer(s.target,e),t.enableVertexAttribArray(a),t.vertexAttribPointer(a,o.numComponents,o.componentType,o.normalized,s.byteStride,o.byteOffset)}}return this.glObjects.set(e,i),i}prepareMesh(e){for(const t of e.primitives)this.preparePrimitive(t)}prepare3dObject(e){e.mesh&&this.prepareMesh(e.mesh);for(const t of e.children)this.prepare3dObject(t)}prepareScene(e){const t=e.findNodes(e=>e instanceof o.Light).length;if(0===t)throw new Error("Scene must have at least 1 light");this.preparePrograms({numberOfLights:t});for(const t of e.nodes)this.prepare3dObject(t)}render(e,t){const i=this.gl;i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT);let r=n.mat4.create(),s=n.mat4.create(),a=[],c=[];const l=t.getGlobalTransform();n.mat4.invert(l,l),n.mat4.copy(r,l);let u=0;e.traverse({onEnter:e=>{a.push(n.mat4.clone(r)),c.push(n.mat4.clone(s)),n.mat4.mul(r,r,e.matrix),n.mat4.mul(s,s,e.matrix),e instanceof o.Light&&(this.renderLight(e,u),u++),this.renderObject3D(e,{viewModel:r,model:s,projection:t.projection})},onLeave:()=>{r=a.pop(),s=c.pop()}})}renderLight(e,t){const{gl:i,defaultProgram:r}=this;function o(e){return`${e}[${t}]`}let s=n.vec3.clone(e.color);n.vec3.scale(s,s,1/255),i.uniform3fv(r.uniforms[o("uLightColor")],s);let a=[0,0,0];n.mat4.getTranslation(a,e.matrix),i.uniform3fv(r.uniforms[o("uLightPosition")],a),i.uniform1i(r.uniforms[o("uLightType")],function(){switch(!0){case e instanceof l.AmbientLight:return 0;case e instanceof c.DirectionalLight:return 1;case e instanceof u.PointLight:return 2;default:throw new Error("Unknown light type: "+JSON.stringify(e))}}()),i.uniform1f(r.uniforms[o("uLightIntensity")],e.intensity),e instanceof c.DirectionalLight&&i.uniform3fv(r.uniforms[o("uLightDirection")],e.direction)}renderObject3D(e,t){const i=this.defaultProgram;if(this.gl.uniformMatrix4fv(i.uniforms.uModel,!1,t.model),this.gl.uniformMatrix4fv(i.uniforms.uViewModel,!1,t.viewModel),e.mesh)for(const i of e.mesh.primitives)this.renderPrimitive(i,t)}renderPrimitive(e,t){const i=this.gl,n=this.glObjects.get(e),r=e.material;let o=this.defaultProgram;r instanceof a.default&&(o=this.programs.get(r)),i.useProgram(o.program),i.uniformMatrix4fv(o.uniforms.uProjection,!1,t.projection),i.uniformMatrix4fv(o.uniforms.uViewModel,!1,t.viewModel),i.uniform1i(o.uniforms.uTexture,0),i.uniform4fv(o.uniforms.uBaseColorFactor,r.baseColorFactor),i.uniformMatrix3fv(o.uniforms.uBaseColorTransform,!1,r.baseColorTransform),r instanceof a.default&&this.setShaderUniformValues(o,r);const s=r.baseColorTexture,c=this.glObjects.get(null==s?void 0:s.image),l=this.glObjects.get(null==s?void 0:s.sampler);if(i.bindVertexArray(n),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,c||this.defaultTexture),i.bindSampler(0,l),e.indices){const t=e.mode,n=e.indices.count,r=e.indices.componentType;i.drawElements(t,n,r,0)}else{const t=e.mode,n=e.attributes.POSITION.count;i.drawArrays(t,0,n)}}setShaderUniformValues(e,t){for(const i in t.uniforms){const n=t.uniforms[i],r="uniform"+n.type;for(const t of this.getGlUniformParamNames(i,n)){const i=e.uniforms[t];if(!this.gl[r])throw new Error(`GLSL uniform type ${n.type} not supported!`);"object"==typeof n.value&&!n.type.endsWith("v")?this.gl[r](i,...n.value):this.gl[r](i,n.value)}}}getGlUniformParamNames(e,t){if(!t.type.endsWith("v"))return[e];if("object"!=typeof t.value)throw new Error("Expected array uniform value: "+t);const i=[];for(let n=0;n<t.value.length;n++)i.push(`${e}[${n}]`);return i}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebGL=void 0;class n{static buildProgram(e,t){try{return n.createProgram(e,[n.createShader(e,t.vertex,e.VERTEX_SHADER),n.createShader(e,t.fragment,e.FRAGMENT_SHADER)])}catch(e){throw new Error("Error compiling \n"+e)}}static createProgram(e,t){const i=e.createProgram();for(const n of t)e.attachShader(i,n);e.linkProgram(i);if(!e.getProgramParameter(i,e.LINK_STATUS)){const t=e.getProgramInfoLog(i);throw new Error("Cannot link program\nInfo log:\n"+t)}const n={},r=e.getProgramParameter(i,e.ACTIVE_ATTRIBUTES);for(let t=0;t<r;t++){const r=e.getActiveAttrib(i,t);n[r.name]=e.getAttribLocation(i,r.name)}const o={},s=e.getProgramParameter(i,e.ACTIVE_UNIFORMS);for(let t=0;t<s;t++){const n=e.getActiveUniform(i,t);o[n.name]=e.getUniformLocation(i,n.name);for(let t=1;t<n.size;t++){const r=n.name.replace("[0]",`[${t}]`);o[r]=e.getUniformLocation(i,r)}}return{program:i,attributes:n,uniforms:o}}static createShader(e,t,i){const n=e.createShader(i);e.shaderSource(n,t),e.compileShader(n);if(!e.getShaderParameter(n,e.COMPILE_STATUS)){const i=e.getShaderInfoLog(n);throw new Error(`Cannot compile shader:\n${t}Info log:\n${i}`)}return n}static createTexture(e,t){const i=t.target||e.TEXTURE_2D,n=t.iformat||e.RGBA,r=t.format||e.RGBA,o=t.type||e.UNSIGNED_BYTE,s=t.texture||e.createTexture();return void 0!==t.unit&&e.activeTexture(e.TEXTURE0+t.unit),e.bindTexture(i,s),t.image?e.texImage2D(i,0,n,r,o,t.image):e.texImage2D(i,0,n,t.width,t.height,0,r,o,t.data),t.wrapS&&e.texParameteri(i,e.TEXTURE_WRAP_S,t.wrapS),t.wrapT&&e.texParameteri(i,e.TEXTURE_WRAP_T,t.wrapT),t.min&&e.texParameteri(i,e.TEXTURE_MIN_FILTER,t.min),t.mag&&e.texParameteri(i,e.TEXTURE_MAG_FILTER,t.mag),t.mip&&e.generateMipmap(i),s}static createBuffer(e,t){const i=t.target||e.ARRAY_BUFFER,n=t.hint||e.STATIC_DRAW,r=t.buffer||e.createBuffer();return e.bindBuffer(i,r),e.bufferData(i,t.data,n),r}static createSampler(e,t){const i=t.sampler||e.createSampler();return t.wrapS&&e.samplerParameteri(i,e.TEXTURE_WRAP_S,t.wrapS),t.wrapT&&e.samplerParameteri(i,e.TEXTURE_WRAP_T,t.wrapT),t.min&&e.samplerParameteri(i,e.TEXTURE_MIN_FILTER,t.min),t.mag&&e.samplerParameteri(i,e.TEXTURE_MAG_FILTER,t.mag),i}}t.WebGL=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFragmentShader=t.createVertexShader=void 0;t.createVertexShader=({numberOfLights:e})=>`\n#version 300 es\nprecision mediump float;\nlayout (location = 0) in vec3 aPosition;\nlayout (location = 1) in vec2 aTexCoord;\nlayout (location = 2) in vec3 aNormal;\n\n// TODO: Should we rename "model" to "world"?\n// See: https://webgl2fundamentals.org/webgl/lessons/webgl-matrix-naming.html\n\nuniform vec3 uLightPosition[${e}];\nuniform mat4 uModel;\nuniform mat4 uViewModel;\nuniform mat4 uProjection;\n\nout vec3 vVertexViewPosition;\nout vec3 vVertexPosition;\nout vec3 vNormal;\nout vec2 vTexCoord;\nout vec3 vSurfaceToLight[${e}];\n\nvoid main() {\n    vVertexPosition = aPosition;\n    vVertexViewPosition = (uViewModel * vec4(aPosition, 1)).xyz;\n    // Transform normals to update lightning calculation when vertex is transformed (rotated).\n    vNormal = mat3(uModel) * aNormal;\n    vTexCoord = aTexCoord;\n    gl_Position = uProjection * uViewModel * vec4(aPosition, 1);\n    \n    vec3 surfaceModalPosition = (aPosition * mat3(uModel)).xyz;\n    for (int i = 0; i < ${e}; i++) {\n        vec3 lightModelPosition = uLightPosition[i] * mat3(uModel);\n        vSurfaceToLight[i] = lightModelPosition - surfaceModalPosition;\n    }\n\n}`.trim();t.createFragmentShader=({numberOfLights:e})=>`\n#version 300 es\nprecision mediump float;\n\nuniform mat4 uViewModel;\nuniform mediump sampler2D uTexture;\nuniform vec4 uBaseColorFactor;\nuniform mat3 uBaseColorTransform;\nuniform vec3 uLightPosition[${e}];\nuniform vec3 uLightDirection[${e}];\nuniform vec3 uLightColor[${e}];\nuniform float uLightIntensity[${e}];\nuniform int uLightType[${e}];\n\nin vec3 vSurfaceToLight[${e}];\nin vec3 vVertexViewPosition;\nin vec3 vNormal;\nin vec2 vTexCoord;\n\nout vec4 oColor;\n\nint LIGHT_TYPE_AMBIENT = 0;\nint LIGHT_TYPE_DIRECTIONAL = 1;\nint LIGHT_TYPE_POINT = 2;\n\nvoid main() {\n    vec3 summedLight = vec3(0, 0, 0);\n    \n    for (int i = 0; i < ${e}; i++) {\n        vec3 surfaceNormal = normalize(vNormal);\n        int lightType = uLightType[i];\n        vec3 light = vec3(0, 0, 0);\n        \n        if (lightType == LIGHT_TYPE_AMBIENT) {\n            light = uLightColor[i]; \n        }\n        \n        if (lightType == LIGHT_TYPE_DIRECTIONAL) {\n            float directionalIntensity = dot(surfaceNormal, uLightDirection[i]);\n            light = uLightColor[i] * directionalIntensity;\n        }\n        \n        if (lightType == LIGHT_TYPE_POINT) {\n            float distanceToLight = length(vSurfaceToLight[i]);\n            float attenuation = 1.0 / (distanceToLight * distanceToLight);\n            float directionalIntensity = dot(surfaceNormal, vSurfaceToLight[i]);\n            // Ignore negative factors, otherwise this step could take away light from other sources.\n            light = uLightColor[i] * max(directionalIntensity, 0.0) * attenuation;\n        }\n        \n        // Temp solution: cap intensity to avoid very bright spots on models.\n        summedLight += min(light * uLightIntensity[i], 1.0);\n     }\n     \n    vec2 uvTransformed = (vec3(vTexCoord, 1.0) * uBaseColorTransform).xy;\n        \n    oColor += texture(uTexture, uvTransformed) * uBaseColorFactor * vec4(summedLight, 1);\n}`.trim()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(5);class r extends n.Material{constructor(e){var t;super(e),this.fragmentShader=e.fragmentShader,this.uniforms=null!==(t=e.uniforms)&&void 0!==t?t:{}}setUniform(e,t){this.uniforms[e].value=t}}t.default=r},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TestScene=void 0;const r=i(11),o=i(22),s=i(15),a=i(39),c=i(8),l=i(9),u=i(25),d=i(42),h=i(0),f=i(6);class p extends r.GameScene{start(){const e=Object.create(null,{start:{get:()=>super.start}});return n(this,void 0,void 0,(function*(){const t=new o.GLTFLoader;yield t.load("./models/test.gltf");const i=yield t.loadScene(t.defaultScene),n=new h.Material,r=i.findNodesByNamePattern("Wall.*");for(const e of r)this.addNode(new u.Wall(e,{physicsMaterial:n}));const p=i.findNodesByNamePattern("Floor")[0];this.addNode(new d.Floor(p,{physicsMaterial:n}));const m=new h.Material;this.addNode(new s.Sphere({radius:1,physicsMaterial:m,translation:[3,10,-5]})),this.addNode(new a.Cube({scale:[1,5,1],translation:[-3,1,-5]})),this.addNode(new a.Cube({name:"Stretched cube",scale:[1,5,5],translation:[-6,1,-5]})),this.addNode(new c.AmbientLight({color:[0,0,100]})),this.addNode(new l.DirectionalLight({color:[100,100,100],translation:[0,10,0],direction:[1,1,0]})),this.world.addContactMaterial(new h.ContactMaterial(n,m,{friction:0,restitution:1})),this.addNode(new f.Player({physicsMaterial:m,translation:[0,2,0]})),yield e.start.call(this)}))}}t.TestScene=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OrthographicCamera=void 0;const n=i(1),r=i(14);class o extends r.Camera{constructor(e={}){var t,i,r,o,s,a;super(e),this.left=null!==(t=e.left)&&void 0!==t?t:-1,this.right=null!==(i=e.right)&&void 0!==i?i:1,this.bottom=null!==(r=e.bottom)&&void 0!==r?r:-1,this.top=null!==(o=e.top)&&void 0!==o?o:1,this.near=null!==(s=e.near)&&void 0!==s?s:-1,this.far=null!==(a=e.far)&&void 0!==a?a:1,this.projection=n.mat4.create(),this.updateProjection()}updateProjection(){n.mat4.ortho(this.projection,this.left,this.right,this.bottom,this.top,this.near,this.far)}}t.OrthographicCamera=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deep=void 0,t.deep=function(e,t){let i=JSON.parse(JSON.stringify(e)),n=t.split(".").reverse(),r=n.pop();for(;n.length>0;)if(i=i[r],r=n.pop(),!i)return;return i[r]}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Cube=void 0;const r=i(2),o=i(0),s=i(7),a=i(40);class c extends r.GameObject{constructor(e){var t;super(e),this.name=null!==(t=e.name)&&void 0!==t?t:"Cube"}load(){return n(this,void 0,void 0,(function*(){this.mesh=new s.Mesh({primitives:[new a.CubePrimitive({size:1})]}),this.body=new o.Body({mass:5,shape:new o.Box(new o.Vec3(1,1,1)),position:new o.Vec3(...this.translation),quaternion:new o.Quaternion(...this.rotation)})}))}update(){this.translation=this.body.position.toArray(),this.updateMatrix()}}t.Cube=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CubePrimitive=void 0;const n=i(17),r=i(18);class o extends r.TwglPrimitive{constructor(e){super(Object.assign(Object.assign({},e),{vertices:n.primitives.createCubeVertices(e.size)}))}}t.CubePrimitive=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.meshToCannonShape=void 0;const n=i(0);t.meshToCannonShape=function(e){if(e.primitives.length>1)throw new Error("Expected a single primitive per mesh, got: "+JSON.stringify(e.primitives));const t=e.primitives[0];return new n.Trimesh(function(e){const t=new Float32Array(e.buffer,e.byteOffset,e.byteLength/Float32Array.BYTES_PER_ELEMENT);return Array.from(t)}(t.attributes.POSITION.bufferView),function(e){const t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/Uint16Array.BYTES_PER_ELEMENT);return Array.from(t)}(t.indices.bufferView))}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Floor=void 0;const r=i(2),o=i(0);class s extends r.GameObject{constructor(e,t){super(),Object.assign(this,e),this.physicsMaterial=t.physicsMaterial}load(){return n(this,void 0,void 0,(function*(){this.body=new o.Body({type:o.BODY_TYPES.STATIC,position:new o.Vec3(...this.translation),material:this.physicsMaterial,quaternion:(new o.Quaternion).setFromEuler(-Math.PI/2,0,0),shape:new o.Plane})}))}update(){this.translation=this.body.position.toArray(),this.updateMatrix()}}t.Floor=s},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LabyrinthScene=void 0;const r=i(11),o=i(22),s=i(25),a=i(0),c=i(6),l=i(44),u=i(8),d=i(46),h=i(47),f=i(27);class p extends r.GameScene{start(){const e=Object.create(null,{start:{get:()=>super.start}});return n(this,void 0,void 0,(function*(){const t=new o.GLTFLoader;yield t.load("./models/level.gltf");const i=yield t.loadScene(t.defaultScene),n=new o.GLTFLoader;yield n.load("./models/key.gltf");const r=yield n.loadScene(n.defaultScene),p=i.findNodesByName("Door")[0];if(!p)throw new Error("Door not found in the loaded scene");const m=r.findNodesByNamePattern("Key")[0];if(!m)throw new Error("Key not found in the loaded scene");const v=new a.Material,y=new a.Material,g=new a.Material;this.winDoor=new d.Door(p,{physicsMaterial:y}),this.addNode(this.winDoor),this.addNode(...i.findNodesByNamePattern("Light")),this.addNode(new h.Sky),this.addNode(new u.AmbientLight({color:[45,80,160],intensity:.5}));const b=i.findNodesByNamePattern("Wall")[0],w=new s.Wall(b,{physicsMaterial:y}),x=()=>{const e=this.getRandomKeyWorldPosition(w.body.aabb);return e.y=2,new l.Key(m.clone(),{physicsMaterial:v,translation:[e.x,e.y,e.z],rotation:[0,0,0,0],scale:[.05,.05,.05]})};this.keys=[x(),x(),x(),x()],this.addNode(...this.keys),this.addNode(w),this.player=new c.Player({physicsMaterial:g,translation:[0,2,0]}),this.addNode(this.player),yield e.start.call(this),this.player.body.addEventListener(a.Body.COLLIDE_EVENT_NAME,this.handlePlayerCollision.bind(this)),this.scheduleGameLostIn(300);f.UiController.create().setKeysFound({foundKeys:0,totalKeys:this.keys.length})}))}getRandomKeyWorldPosition(e){return this.getRandomVector(e.lowerBound.scale(.9),e.upperBound.scale(.9))}getRandomVector(e,t){return new a.Vec3(this.getRandomScalar(e.x,t.x),this.getRandomScalar(e.y,t.y),this.getRandomScalar(e.z,t.z))}getRandomScalar(e,t){return Math.random()*(t-e)+e}handlePlayerCollision(e){const t=f.UiController.create(),i=this.keys.find(t=>t.body===e.body),n=this.winDoor.body===e.body;i&&(console.log("Player collided with key: ",i),i.despawn(),this.player.pickupKey(i),t.setKeysFound({foundKeys:this.player.foundKeys.length,totalKeys:this.keys.length}));const r=this.player.foundKeys.length===this.keys.length;n&&r&&(this.player.controls.disable(),t.showWinScreen())}scheduleGameLostIn(e){const t=f.UiController.create();let i=e;const n=setInterval(()=>{i--,t.setTimeLeft(i),i<=0&&(clearInterval(n),this.player.controls.disable(),t.showLoseScreen())},1e3)}}t.LabyrinthScene=p},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Key=void 0;const r=i(2),o=i(0),s=i(1),a=i(26);class c extends r.GameObject{constructor(e,t){super(),this.sound=new a.Howl({src:["./sounds/kill_sound.mp3"],html5:!0,volume:1}),Object.assign(this,Object.assign(Object.assign({},e),t)),this.physicsMaterial=t.physicsMaterial}load(){return n(this,void 0,void 0,(function*(){const e=new o.Sphere(.15);this.body=new o.Body({mass:.01,material:this.physicsMaterial,position:new o.Vec3(...this.translation),quaternion:new o.Quaternion(...this.rotation),shape:e})}))}update(e,t){this.translation=this.body.position.toArray();const i=100*t%360;s.quat.fromEuler(this.rotation,i,0,-90),this.updateMatrix()}despawn(){this.body.position=new o.Vec3(0,-10,0),this.body.mass=0,this.sound.play()}}t.Key=c},,function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Door=void 0;const r=i(2),o=i(0);class s extends r.GameObject{constructor(e,t){super(),Object.assign(this,e),this.physicsMaterial=t.physicsMaterial}load(){return n(this,void 0,void 0,(function*(){const e=new o.Vec3(10,20,3).vmul(new o.Vec3(...this.scale)),t=new o.Box(e);this.body=new o.Body({type:o.BODY_TYPES.STATIC,material:this.physicsMaterial,position:new o.Vec3(...this.translation),quaternion:new o.Quaternion(...this.rotation),shape:t})}))}update(){this.translation=this.body.position.toArray(),this.updateMatrix()}}t.Door=s},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Sky=void 0;const r=i(7),o=i(16),s=i(5),a=i(24),c=i(2),l=i(1);class u extends c.GameObject{constructor(){super({name:"Sky sphere",scale:[1,1,-1],mesh:new r.Mesh({primitives:[new o.SpherePrimitive({radius:20,subdivisionsAxis:10,subdivisionsHeight:10})]})})}load(){return n(this,void 0,void 0,(function*(){this.mesh.setMaterial(new s.Material({baseColorFactor:[3,3,3,3],baseColorTexture:new a.Texture({image:yield this.fetchImage("./models/sky.jpg")})})),l.quat.fromEuler(this.rotation,90,0,0),this.updateMatrix()}))}update(e,t){}fetchImage(e){return new Promise((t,i)=>{let n=new Image;n.addEventListener("load",e=>t(n)),n.addEventListener("error",i),n.src=new URL(e,window.location.href).toString()})}}t.Sky=u}]);
//# sourceMappingURL=main.bundle.js.map